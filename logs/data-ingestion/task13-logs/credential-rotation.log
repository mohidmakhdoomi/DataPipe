[2025-10-21 14:19:34] [INFO] Starting Task 13: Data-Ingestion-Specific Security Procedures
[2025-10-21 14:19:34] [INFO] Component: postgresql, Dry Run: true, Verbose: false
[2025-10-21 14:19:34] [INFO] Log file: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-21 14:19:34] [INFO] Validating prerequisites...
[2025-10-21 14:19:34] [SUCCESS] Prerequisites validation passed
[2025-10-21 14:19:34] [INFO] Running pre-flight checks...
[2025-10-21 14:19:35] [INFO] Memory usage check skipped (format: 738Mi)
[2025-10-21 14:19:35] [SUCCESS] Pre-flight checks passed
[2025-10-21 14:19:35] [INFO] Starting PostgreSQL CDC user credential rotation...
[2025-10-21 14:19:35] [INFO] [DRY-RUN] Would create new PostgreSQL user: debezium_20251021_141935
[2025-10-21 14:19:35] [INFO] Running end-to-end validation...
[2025-10-21 14:19:36] [INFO] Testing end-to-end data flow in 20s ...
[2025-10-21 14:20:03] [INFO] Waiting for CDC to process INSERT...
[2025-10-21 14:22:05] [INFO] CDC test passed
[2025-10-21 14:22:05] [SUCCESS] End-to-end validation completed successfully
[2025-10-21 14:22:05] [SUCCESS] Task 13 credential rotation completed successfully!
[2025-10-21 14:22:05] [INFO] Log file saved to: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-21 14:22:12] [INFO] Starting Task 13: Data-Ingestion-Specific Security Procedures
[2025-10-21 14:22:12] [INFO] Component: all, Dry Run: false, Verbose: true
[2025-10-21 14:22:12] [INFO] Log file: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-21 14:22:12] [INFO] Validating prerequisites...
[2025-10-21 14:22:13] [SUCCESS] Prerequisites validation passed
[2025-10-21 14:22:13] [INFO] Running pre-flight checks...
[2025-10-21 14:22:13] [INFO] Memory usage check skipped (format: 742Mi)
[2025-10-21 14:22:13] [SUCCESS] Pre-flight checks passed
[2025-10-21 14:22:14] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |        789 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281248616 | f
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |        785 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281248616 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |        784 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281248616 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |       1101 |      |        16417 | 0/57D15378  | 0/57D15378          | reserved   |    4298025832 | f
(4 rows)
[2025-10-21 14:22:14] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
      rolname     | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
-----------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres        | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium        | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
(3 rows)
[2025-10-21 14:22:14] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid  | usesysid | usename  |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn  | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
------+----------+----------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+------------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 1101 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       45698 | 2025-10-21 18:03:50.16161+00  |              | streaming | 0/57D15498 | 0/57D15498 | 0/57D15378 | 0/57D15378 | 00:00:07.184861 | 00:00:25.34254  | 00:00:25.34254  |             0 | async      | 1999-12-21 01:02:12.796134+00
  784 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       33882 | 2025-10-21 18:01:40.124346+00 |              | streaming | 0/57D15498 | 0/57D15498 |            |            | 00:00:08.124768 | 00:20:28.162956 | 00:20:28.162956 |             0 | async      | 1999-12-21 01:02:12.797073+00
  785 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       33884 | 2025-10-21 18:01:40.124758+00 |              | streaming | 0/57D15498 | 0/57D15498 |            |            | 00:00:07.963294 | 00:20:28.015609 | 00:20:28.015609 |             0 | async      | 1999-12-21 01:02:12.796912+00
  789 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       33952 | 2025-10-21 18:01:40.32026+00  |              | streaming | 0/57D15498 | 0/57D15498 |            |            | 00:00:08.124385 | 00:20:27.963208 | 00:20:27.963208 |             0 | async      | 1999-12-21 01:02:12.797074+00
(4 rows)
[2025-10-21 14:22:14] [INFO] Creating backup of current credentials...
[2025-10-21 14:22:15] [INFO] Starting PostgreSQL CDC user credential rotation...
[2025-10-21 14:22:15] [INFO] Current CDC user: debezium
[2025-10-21 14:22:15] [INFO] Creating new CDC user: debezium_20251021_142215
[2025-10-21 14:22:16] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |        789 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |        785 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |        784 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |       1101 |      |        16417 | 0/57D15378  | 0/57D15378          | reserved   |    4298020720 | f
(4 rows)
[2025-10-21 14:22:16] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251021_142215 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16494
(4 rows)
[2025-10-21 14:22:16] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid  | usesysid | usename  |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn  | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
------+----------+----------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+------------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 1101 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       45698 | 2025-10-21 18:03:50.16161+00  |              | streaming | 0/57D16890 | 0/57D15498 | 0/57D15378 | 0/57D15378 | 00:00:07.184861 | 00:00:25.34254  | 00:00:25.34254  |             0 | async      | 1999-12-21 01:02:12.796134+00
  784 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       33882 | 2025-10-21 18:01:40.124346+00 |              | streaming | 0/57D16890 | 0/57D15498 |            |            | 00:00:08.124768 | 00:20:28.162956 | 00:20:28.162956 |             0 | async      | 1999-12-21 01:02:12.797073+00
  785 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       33884 | 2025-10-21 18:01:40.124758+00 |              | streaming | 0/57D16890 | 0/57D15498 |            |            | 00:00:07.963294 | 00:20:28.015609 | 00:20:28.015609 |             0 | async      | 1999-12-21 01:02:12.796912+00
  789 |    16471 | debezium | Debezium Streaming | 10.244.2.9  |                 |       33952 | 2025-10-21 18:01:40.32026+00  |              | streaming | 0/57D16890 | 0/57D15498 |            |            | 00:00:08.124385 | 00:20:27.963208 | 00:20:27.963208 |             0 | async      | 1999-12-21 01:02:12.797074+00
(4 rows)
[2025-10-21 14:22:16] [INFO] Pausing Debezium connectors...
[2025-10-21 14:22:22] [INFO] Validating new user has proper replication permissions...
[2025-10-21 14:22:22] [INFO] New user has proper replication permissions - can use existing slot
[2025-10-21 14:22:22] [INFO] Updating Kubernetes secret with new credentials...
[2025-10-21 14:22:22] [INFO] Deleting Kafka Connect pod to force restart...
[2025-10-21 14:23:37] [INFO] Resuming Debezium connectors after 20s ...
[2025-10-21 14:24:03] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3975 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3976 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3973 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3974 |      |        16417 | 0/57D15378  | 0/57D15378          | reserved   |    4298020720 | f
(4 rows)
[2025-10-21 14:24:04] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251021_142215 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16494
(4 rows)
[2025-10-21 14:24:04] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 3973 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43334 | 2025-10-21 18:23:58.763657+00 |              | streaming | 0/57D16890 | 0/56DC0888 |           |            | 00:00:00.013845 | 00:00:00.013845 | 00:00:00.013845 |             0 | async      | 1999-12-21 01:02:12.904832+00
 3974 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43336 | 2025-10-21 18:23:58.76407+00  |              | streaming | 0/57D16890 | 0/57D15378 |           |            | 00:00:00.006806 | 00:00:00.006806 | 00:00:00.006806 |             0 | async      | 1999-12-21 01:02:12.904833+00
 3975 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43338 | 2025-10-21 18:23:58.764587+00 |              | streaming | 0/57D16890 | 0/56DC0888 |           |            | 00:00:00.013138 | 00:00:00.013138 | 00:00:00.013138 |             0 | async      | 1999-12-21 01:02:12.904831+00
 3976 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43340 | 2025-10-21 18:23:58.765025+00 |              | streaming | 0/57D16890 | 0/56DC0888 |           |            | 00:00:00.0109   | 00:00:00.0109   | 00:00:00.0109   |             0 | async      | 1999-12-21 01:02:12.904835+00
(4 rows)
[2025-10-21 14:24:04] [INFO] Validating replication slot activity and new user connection...
[2025-10-21 14:24:19] [INFO] New user 'debezium_20251021_142215' is successfully connected for replication
[2025-10-21 14:24:19] [INFO] Validating CDC functionality...
[2025-10-21 14:24:20] [INFO] CDC is successfully processing changes after rotation
[2025-10-21 14:24:20] [INFO] Old user 'debezium' should be cleaned up after validation period
[2025-10-21 14:24:20] [INFO] To clean up old user after validation, run:
[2025-10-21 14:24:20] [INFO] kubectl --context "kind-data-ingestion" exec -n data-ingestion postgresql-0 -- psql -U postgres -d ecommerce -c "DROP USER IF EXISTS debezium;"
[2025-10-21 14:24:20] [SUCCESS] PostgreSQL CDC user rotation completed successfully
[2025-10-21 14:24:20] [INFO] Starting Kafka Connect service account credential rotation...
[2025-10-21 14:24:20] [INFO] Kafka Connect service account rotation completed (using PostgreSQL credential rotation)
[2025-10-21 14:24:20] [INFO] Starting Schema Registry credential rotation...
[2025-10-21 14:24:21] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3975 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3976 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3973 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243504 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |       3974 |      |        16417 | 0/57D15378  | 0/57D15378          | reserved   |    4298020720 | f
(4 rows)
[2025-10-21 14:24:21] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251021_142215 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16494
(4 rows)
[2025-10-21 14:24:21] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 3973 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43334 | 2025-10-21 18:23:58.763657+00 |              | streaming | 0/57D16890 | 0/57D16890 |           |            | 00:00:10.011014 | 00:00:20.011176 | 00:00:20.011176 |             0 | async      | 1999-12-21 01:02:12.92483+00
 3974 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43336 | 2025-10-21 18:23:58.76407+00  |              | streaming | 0/57D16890 | 0/57D16890 |           |            | 00:00:10.005945 | 00:00:20.006069 | 00:00:20.006069 |             0 | async      | 1999-12-21 01:02:12.924833+00
 3975 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43338 | 2025-10-21 18:23:58.764587+00 |              | streaming | 0/57D16890 | 0/57D16890 |           |            | 00:00:10.011291 | 00:00:20.011443 | 00:00:20.011443 |             0 | async      | 1999-12-21 01:02:12.92483+00
 3976 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.10 |                 |       43340 | 2025-10-21 18:23:58.765025+00 |              | streaming | 0/57D16890 | 0/57D16890 |           |            | 00:00:10.009036 | 00:00:20.009262 | 00:00:20.009262 |             0 | async      | 1999-12-21 01:02:12.924834+00
(4 rows)
[2025-10-21 14:24:21] [INFO] Pausing Debezium connectors...
[2025-10-21 14:24:27] [INFO] Updating Schema Registry credentials in Kubernetes secret...
[2025-10-21 14:24:27] [INFO] Deleting Schema Registry pod to force restart...
[2025-10-21 14:25:29] [INFO] Deleting Kafka Connect pod to use new Schema Registry credentials...
[2025-10-21 14:26:43] [INFO] Resuming Debezium connectors after 20s ...
[2025-10-21 14:27:09] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4462 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243272 | f
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4464 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243272 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4463 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281243272 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4461 |      |        16417 | 0/57D15378  | 0/57D15378          | reserved   |    4298020488 | f
(4 rows)
[2025-10-21 14:27:09] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251021_142215 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16494
(4 rows)
[2025-10-21 14:27:10] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 4461 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38322 | 2025-10-21 18:27:04.69911+00  |              | streaming | 0/57D16978 | 0/57D15378 |           |            | 00:00:00.009043 | 00:00:00.009043 | 00:00:00.009043 |             0 | async      | 1999-12-21 01:02:13.090773+00
 4462 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38324 | 2025-10-21 18:27:04.699702+00 |              | streaming | 0/57D16978 | 0/56DC0888 |           |            | 00:00:00.010989 | 00:00:00.010989 | 00:00:00.010989 |             0 | async      | 1999-12-21 01:02:13.090774+00
 4463 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38326 | 2025-10-21 18:27:04.70016+00  |              | streaming | 0/57D16978 | 0/56DC0888 |           |            | 00:00:00.012838 | 00:00:00.012838 | 00:00:00.012838 |             0 | async      | 1999-12-21 01:02:13.090771+00
 4464 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38328 | 2025-10-21 18:27:04.700586+00 |              | streaming | 0/57D16978 | 0/56DC0888 |           |            | 00:00:00.011607 | 00:00:00.011607 | 00:00:00.011607 |             0 | async      | 1999-12-21 01:02:13.090773+00
(4 rows)
[2025-10-21 14:27:10] [SUCCESS] Schema Registry credential rotation completed successfully
[2025-10-21 14:27:10] [INFO] Running end-to-end validation...
[2025-10-21 14:27:10] [INFO] Testing end-to-end data flow in 20s ...
[2025-10-21 14:27:31] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4462 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281234976 | f
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4464 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281234976 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4463 |      |        15741 | 0/56DC0888  | 0/56DC0888          | reserved   |    4281234976 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |       4461 |      |        16417 | 0/57D15378  | 0/57D15378          | reserved   |    4298012192 | f
(4 rows)
[2025-10-21 14:27:31] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251021_142215 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16494
(4 rows)
[2025-10-21 14:27:31] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 4461 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38322 | 2025-10-21 18:27:04.69911+00  |              | streaming | 0/57D189E0 | 0/57D189E0 |           |            | 00:00:10.007024 | 00:00:20.007174 | 00:00:20.007174 |             0 | async      | 1999-12-21 01:02:13.110772+00
 4462 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38324 | 2025-10-21 18:27:04.699702+00 |              | streaming | 0/57D189E0 | 0/57D189E0 |           |            | 00:00:10.010121 | 00:00:20.010228 | 00:00:20.010228 |             0 | async      | 1999-12-21 01:02:13.110774+00
 4463 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38326 | 2025-10-21 18:27:04.70016+00  |              | streaming | 0/57D189E0 | 0/57D189E0 |           |            | 00:00:10.011905 | 00:00:20.012079 | 00:00:20.012079 |             0 | async      | 1999-12-21 01:02:13.110771+00
 4464 |    16494 | debezium_20251021_142215 | Debezium Streaming | 10.244.2.11 |                 |       38328 | 2025-10-21 18:27:04.700586+00 |              | streaming | 0/57D189E0 | 0/57D189E0 |           |            | 00:00:10.010151 | 00:00:20.009319 | 00:00:20.009319 |             0 | async      | 1999-12-21 01:02:13.110772+00
(4 rows)
[2025-10-21 14:27:31] [DEBUG] schema.registry.basic.auth.user.info=admin:qq4u6SB2zdiDwXLAZtOSEAFaw
[2025-10-21 14:27:31] [DEBUG] Waiting 6 seconds for kafka-avro-console-consumer to start...
[2025-10-21 14:27:38] [INFO] Waiting for CDC to process INSERT...
[2025-10-21 14:29:40] [INFO] CDC test passed
[2025-10-21 14:29:40] [SUCCESS] End-to-end validation completed successfully
[2025-10-21 14:29:41] [SUCCESS] Task 13 credential rotation completed successfully!
[2025-10-21 14:29:41] [INFO] Log file saved to: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-21 14:29:41] [INFO] Remember to:
[2025-10-21 14:29:41] [INFO] 1. Monitor the pipeline for the next 24 hours
[2025-10-21 14:29:41] [INFO] 2. Clean up old PostgreSQL users after validation period
[2025-10-21 14:29:41] [INFO] 3. Remove credential backups after confirming stability
