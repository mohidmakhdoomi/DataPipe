[2025-10-05 05:18:55] [INFO] Starting Task 13: Data-Ingestion-Specific Security Procedures
[2025-10-05 05:18:55] [INFO] Component: postgresql, Dry Run: true, Verbose: false
[2025-10-05 05:18:55] [INFO] Log file: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-05 05:18:55] [INFO] Validating prerequisites...
[2025-10-05 05:18:56] [SUCCESS] Prerequisites validation passed
[2025-10-05 05:18:56] [INFO] Running pre-flight checks...
[2025-10-05 05:18:56] [INFO] Memory usage check skipped (format: 620Mi)
[2025-10-05 05:18:56] [SUCCESS] Pre-flight checks passed
[2025-10-05 05:18:56] [INFO] Starting PostgreSQL CDC user credential rotation...
[2025-10-05 05:18:57] [INFO] [DRY-RUN] Would create new PostgreSQL user: debezium_20251005_051856
[2025-10-05 05:18:57] [INFO] Running end-to-end validation...
[2025-10-05 05:18:57] [INFO] Testing end-to-end data flow in 20s ...
[2025-10-05 05:19:24] [INFO] Waiting for CDC to process INSERT...
[2025-10-05 05:20:26] [INFO] CDC test passed
[2025-10-05 05:20:26] [SUCCESS] End-to-end validation completed successfully
[2025-10-05 05:20:26] [SUCCESS] Task 13 credential rotation completed successfully!
[2025-10-05 05:20:26] [INFO] Log file saved to: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-05 12:45:07] [INFO] Starting Task 13: Data-Ingestion-Specific Security Procedures
[2025-10-05 12:45:07] [INFO] Component: postgresql, Dry Run: true, Verbose: false
[2025-10-05 12:45:07] [INFO] Log file: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-05 12:45:07] [INFO] Validating prerequisites...
[2025-10-05 12:45:07] [SUCCESS] Prerequisites validation passed
[2025-10-05 12:45:07] [INFO] Running pre-flight checks...
[2025-10-05 12:45:08] [INFO] Memory usage check skipped (format: 599Mi)
[2025-10-05 12:45:08] [SUCCESS] Pre-flight checks passed
[2025-10-05 12:45:08] [INFO] Starting PostgreSQL CDC user credential rotation...
[2025-10-05 12:45:08] [INFO] [DRY-RUN] Would create new PostgreSQL user: debezium_20251005_124508
[2025-10-05 12:45:08] [INFO] Running end-to-end validation...
[2025-10-05 12:45:09] [INFO] Testing end-to-end data flow in 20s ...
[2025-10-05 12:45:35] [INFO] Waiting for CDC to process INSERT...
[2025-10-05 12:46:38] [INFO] CDC test passed
[2025-10-05 12:46:38] [SUCCESS] End-to-end validation completed successfully
[2025-10-05 12:46:38] [SUCCESS] Task 13 credential rotation completed successfully!
[2025-10-05 12:46:38] [INFO] Log file saved to: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-05 12:46:45] [INFO] Starting Task 13: Data-Ingestion-Specific Security Procedures
[2025-10-05 12:46:45] [INFO] Component: all, Dry Run: false, Verbose: true
[2025-10-05 12:46:45] [INFO] Log file: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-05 12:46:45] [INFO] Validating prerequisites...
[2025-10-05 12:46:45] [SUCCESS] Prerequisites validation passed
[2025-10-05 12:46:45] [INFO] Running pre-flight checks...
[2025-10-05 12:46:46] [INFO] Memory usage check skipped (format: 603Mi)
[2025-10-05 12:46:46] [SUCCESS] Pre-flight checks passed
[2025-10-05 12:46:46] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |        431 |      |          772 | 0/1BF6A38   | 0/229B750           | reserved   |    3903027680 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |        432 |      |          772 | 0/1BF6A38   | 0/2679730           | reserved   |    3903027680 | f
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |        433 |      |          780 | 0/29EF7E0   | 0/29EF7E0           | reserved   |    3919804896 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |        757 |      |        10318 | 0/195C3DA0  | 0/195C85E8          | reserved   |    4305680864 | f
(4 rows)
[2025-10-05 12:46:46] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
      rolname     | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
-----------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres        | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium        | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
(3 rows)
[2025-10-05 12:46:47] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid | usesysid | usename  |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn  | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
-----+----------+----------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+------------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 757 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       49120 | 2025-10-05 09:03:11.079371+00 |              | streaming | 0/195C8620 | 0/195C8620 | 0/195C85E8 | 0/195C85E8 | 00:00:05.604104 | 00:00:15.28184  | 00:00:15.28184  |             0 | async      | 1999-12-21 01:02:47.041742+00
 431 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       34912 | 2025-10-05 09:00:58.050013+00 |              | streaming | 0/195C8620 | 0/195C8620 |            |            | 00:00:02.785174 | 07:45:39.791288 | 07:45:39.791288 |             0 | async      | 1999-12-21 01:02:47.038923+00
 432 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       34914 | 2025-10-05 09:00:58.050568+00 |              | streaming | 0/195C8620 | 0/195C8620 |            |            | 00:00:02.788988 | 07:45:39.598952 | 07:45:39.598952 |             0 | async      | 1999-12-21 01:02:47.038927+00
 433 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       34934 | 2025-10-05 09:00:58.051244+00 |              | streaming | 0/195C8620 | 0/195C8620 |            |            | 00:00:02.80023  | 07:45:39.326416 | 07:45:39.326416 |             0 | async      | 1999-12-21 01:02:47.038938+00
(4 rows)
[2025-10-05 12:46:47] [INFO] Creating backup of current credentials...
[2025-10-05 12:46:47] [INFO] Starting PostgreSQL CDC user credential rotation...
[2025-10-05 12:46:47] [INFO] Current CDC user: debezium
[2025-10-05 12:46:47] [INFO] Creating new CDC user: debezium_20251005_124647
[2025-10-05 12:46:48] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |        431 |      |          772 | 0/1BF6A38   | 0/229B750           | reserved   |    3903022592 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |        432 |      |          772 | 0/1BF6A38   | 0/2679730           | reserved   |    3903022592 | f
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |        433 |      |          780 | 0/29EF7E0   | 0/29EF7E0           | reserved   |    3919799808 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |        757 |      |        10318 | 0/195C3DA0  | 0/195C85E8          | reserved   |    4305675776 | f
(4 rows)
[2025-10-05 12:46:48] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251005_124647 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16489
(4 rows)
[2025-10-05 12:46:48] [DEBUG] SELECT * FROM pg_stat_replication; 
  pid | usesysid | usename  |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn  | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
-----+----------+----------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+------------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 757 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       49120 | 2025-10-05 09:03:11.079371+00 |              | streaming | 0/195C9A00 | 0/195C8620 | 0/195C85E8 | 0/195C85E8 | 00:00:05.604104 | 00:00:15.28184  | 00:00:15.28184  |             0 | async      | 1999-12-21 01:02:47.041742+00
 431 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       34912 | 2025-10-05 09:00:58.050013+00 |              | streaming | 0/195C9A00 | 0/195C8620 |            |            | 00:00:00.096427 | 07:45:49.790833 | 07:45:49.790833 |             0 | async      | 1999-12-21 01:02:47.048925+00
 432 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       34914 | 2025-10-05 09:00:58.050568+00 |              | streaming | 0/195C9A00 | 0/195C8620 |            |            | 00:00:00.101105 | 07:45:49.599501 | 07:45:49.599501 |             0 | async      | 1999-12-21 01:02:47.048929+00
 433 |    16471 | debezium | Debezium Streaming | 10.244.1.9  |                 |       34934 | 2025-10-05 09:00:58.051244+00 |              | streaming | 0/195C9A00 | 0/195C8620 |            |            | 00:00:00.111408 | 07:45:49.32598  | 07:45:49.32598  |             0 | async      | 1999-12-21 01:02:47.04894+00
(4 rows)
[2025-10-05 12:46:49] [INFO] Pausing Debezium connectors...
[2025-10-05 12:46:54] [INFO] Validating new user has proper replication permissions...
[2025-10-05 12:46:55] [INFO] New user has proper replication permissions - can use existing slot
[2025-10-05 12:46:55] [INFO] Updating Kubernetes secret with new credentials...
[2025-10-05 12:46:55] [INFO] Deleting Kafka Connect pod to force restart...
[2025-10-05 12:48:08] [INFO] Resuming Debezium connectors after 20s ...
[2025-10-05 12:48:34] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61364 |      |          772 | 0/1BF6A38   | 0/229B750           | reserved   |    3903022008 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61363 |      |          772 | 0/1BF6A38   | 0/2679730           | reserved   |    3903022008 | f
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61365 |      |          780 | 0/29EF7E0   | 0/29EF7E0           | reserved   |    3919799224 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61362 |      |        10318 | 0/195C85E8  | 0/195C85E8          | reserved   |    4305675192 | f
(4 rows)
[2025-10-05 12:48:34] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251005_124647 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16489
(4 rows)
[2025-10-05 12:48:35] [DEBUG] SELECT * FROM pg_stat_replication; 
   pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
-------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 61362 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46200 | 2025-10-05 16:48:29.402135+00 |              | streaming | 0/195C9C48 | 0/195C85E8 |           |            |                 |                 |                 |             0 | async      | 1999-12-21 01:02:47.150175+00
 61363 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46198 | 2025-10-05 16:48:29.402541+00 |              | catchup   | 0/1257E968 | 0/2679730  |           |            |                 |                 |                 |             0 | async      | 1999-12-21 01:02:47.150167+00
 61364 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46212 | 2025-10-05 16:48:29.402922+00 |              | catchup   | 0/1172FE28 | 0/229B750  |           |            |                 |                 |                 |             0 | async      | 1999-12-21 01:02:47.150164+00
 61365 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46228 | 2025-10-05 16:48:29.403487+00 |              | catchup   | 0/13166F48 | 0/29EF7E0  |           |            | 00:00:00.012816 | 00:00:00.012816 | 00:00:00.012816 |             0 | async      | 1999-12-21 01:02:47.15016+00
(4 rows)
[2025-10-05 12:48:35] [INFO] Validating replication slot activity and new user connection...
[2025-10-05 12:48:50] [INFO] New user 'debezium_20251005_124647' is successfully connected for replication
[2025-10-05 12:48:50] [INFO] Validating CDC functionality...
[2025-10-05 12:48:51] [INFO] CDC is successfully processing changes after rotation
[2025-10-05 12:48:51] [INFO] Old user 'debezium' should be cleaned up after validation period
[2025-10-05 12:48:52] [INFO] To clean up old user after validation, run:
[2025-10-05 12:48:52] [INFO] kubectl --context "kind-data-ingestion" exec -n data-ingestion postgresql-0 -- psql -U postgres -d ecommerce -c "DROP USER IF EXISTS debezium;"
[2025-10-05 12:48:52] [SUCCESS] PostgreSQL CDC user rotation completed successfully
[2025-10-05 12:48:52] [INFO] Starting Kafka Connect service account credential rotation...
[2025-10-05 12:48:52] [INFO] Kafka Connect service account rotation completed (using PostgreSQL credential rotation)
[2025-10-05 12:48:52] [INFO] Starting Schema Registry credential rotation...
[2025-10-05 12:48:52] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61364 |      |          772 | 0/1BF6A38   | 0/229B750           | reserved   |    3903022008 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61363 |      |          772 | 0/1BF6A38   | 0/2679730           | reserved   |    3903022008 | f
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61365 |      |          780 | 0/29EF7E0   | 0/29EF7E0           | reserved   |    3919799224 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61362 |      |        10318 | 0/195C85E8  | 0/195C85E8          | reserved   |    4305675192 | f
(4 rows)
[2025-10-05 12:48:52] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251005_124647 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16489
(4 rows)
[2025-10-05 12:48:52] [DEBUG] SELECT * FROM pg_stat_replication; 
   pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
-------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 61362 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46200 | 2025-10-05 16:48:29.402135+00 |              | streaming | 0/195C9C48 | 0/195C9C48 |           |            | 00:00:09.939802 | 00:00:19.939745 | 00:00:19.939745 |             0 | async      | 1999-12-21 01:02:47.170176+00
 61363 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46198 | 2025-10-05 16:48:29.402541+00 |              | streaming | 0/195C9C48 | 0/195C9C48 |           |            | 00:00:02.643186 | 00:00:19.713242 | 00:00:19.713242 |             0 | async      | 1999-12-21 01:02:47.170168+00
 61364 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46212 | 2025-10-05 16:48:29.402922+00 |              | streaming | 0/195C9C48 | 0/195C9C48 |           |            | 00:00:02.813664 | 00:00:19.814848 | 00:00:19.814848 |             0 | async      | 1999-12-21 01:02:47.170165+00
 61365 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.10 |                 |       46228 | 2025-10-05 16:48:29.403487+00 |              | streaming | 0/195C9C48 | 0/195C9C48 |           |            | 00:00:03.01003  | 00:00:20.011044 | 00:00:20.011044 |             0 | async      | 1999-12-21 01:02:47.17016+00
(4 rows)
[2025-10-05 12:48:52] [INFO] Pausing Debezium connectors...
[2025-10-05 12:48:58] [INFO] Updating Schema Registry credentials in Kubernetes secret...
[2025-10-05 12:48:59] [INFO] Deleting Schema Registry pod to force restart...
[2025-10-05 12:50:01] [INFO] Deleting Kafka Connect pod to use new Schema Registry credentials...
[2025-10-05 12:51:15] [INFO] Resuming Debezium connectors after 20s ...
[2025-10-05 12:51:41] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61844 |      |          772 | 0/1BF6A38   | 0/229B750           | reserved   |    3903022008 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61845 |      |          772 | 0/1BF6A38   | 0/2679730           | reserved   |    3903022008 | f
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61849 |      |          780 | 0/29EF7E0   | 0/29EF7E0           | reserved   |    3919799224 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61843 |      |        10318 | 0/195C85E8  | 0/195C85E8          | reserved   |    4305675192 | f
(4 rows)
[2025-10-05 12:51:41] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251005_124647 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16489
(4 rows)
[2025-10-05 12:51:42] [DEBUG] SELECT * FROM pg_stat_replication; 
   pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
-------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 61843 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59072 | 2025-10-05 16:51:36.246002+00 |              | streaming | 0/195C9C48 | 0/195C85E8 |           |            | 00:00:00.012823 | 00:00:00.012823 | 00:00:00.012823 |             0 | async      | 1999-12-21 01:02:47.337014+00
 61845 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59070 | 2025-10-05 16:51:36.247023+00 |              | catchup   | 0/12E5B078 | 0/2679730  |           |            |                 |                 |                 |             0 | async      | 1999-12-21 01:02:47.337076+00
 61844 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59074 | 2025-10-05 16:51:36.246535+00 |              | catchup   | 0/12CED3E8 | 0/229B750  |           |            |                 |                 |                 |             0 | async      | 1999-12-21 01:02:47.337085+00
 61849 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59124 | 2025-10-05 16:51:36.348771+00 |              | catchup   | 0/12E1D7B8 | 0/29EF7E0  |           |            | 00:00:00.011172 | 00:00:00.011172 | 00:00:00.011172 |             0 | async      | 1999-12-21 01:02:47.337124+00
(4 rows)
[2025-10-05 12:51:42] [SUCCESS] Schema Registry credential rotation completed successfully
[2025-10-05 12:51:42] [INFO] Running end-to-end validation...
[2025-10-05 12:51:43] [INFO] Testing end-to-end data flow in 20s ...
[2025-10-05 12:52:03] [DEBUG] SELECT * FROM pg_replication_slots; 
          slot_name         |  plugin  | slot_type | datoid | database  | temporary | active | active_pid | xmin | catalog_xmin | restart_lsn | confirmed_flush_lsn | wal_status | safe_wal_size | two_phase 
---------------------------+----------+-----------+--------+-----------+-----------+--------+------------+------+--------------+-------------+---------------------+------------+---------------+-----------
 debezium_slot_products    | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61844 |      |          772 | 0/1BF6A38   | 0/229B750           | reserved   |    3903021200 | f
 debezium_slot_orders      | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61845 |      |          772 | 0/1BF6A38   | 0/2679730           | reserved   |    3903021200 | f
 debezium_slot_order_items | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61849 |      |          780 | 0/29EF7E0   | 0/29EF7E0           | reserved   |    3919798416 | f
 debezium_slot_users       | pgoutput | logical   |  16384 | ecommerce | f         | t      |      61843 |      |        10318 | 0/195C85E8  | 0/195C85E8          | reserved   |    4305674384 | f
(4 rows)
[2025-10-05 12:52:03] [DEBUG] SELECT * FROM pg_roles WHERE rolname like 'debezium%' OR rolname like 'postgres%'; 
          rolname          | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls |       rolconfig        |  oid  
--------------------------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+------------------------+-------
 postgres                 | t        | t          | t             | t           | t           | t              |           -1 | ********    |               | t            |                        |    10
 debezium_parent          | f        | t          | f             | f           | f           | t              |           -1 | ********    |               | f            |                        | 16457
 debezium                 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16471
 debezium_20251005_124647 | f        | t          | f             | f           | t           | t              |           -1 | ********    |               | f            | {role=debezium_parent} | 16489
(4 rows)
[2025-10-05 12:52:04] [DEBUG] SELECT * FROM pg_stat_replication; 
   pid  | usesysid |         usename          |  application_name  | client_addr | client_hostname | client_port |         backend_start         | backend_xmin |   state   |  sent_lsn  | write_lsn  | flush_lsn | replay_lsn |    write_lag    |    flush_lag    |   replay_lag    | sync_priority | sync_state |          reply_time           
-------+----------+--------------------------+--------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+------------+------------+-----------+------------+-----------------+-----------------+-----------------+---------------+------------+-------------------------------
 61843 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59072 | 2025-10-05 16:51:36.246002+00 |              | streaming | 0/195C9F70 | 0/195C9F70 |           |            | 00:00:10.011991 | 00:00:20.011607 | 00:00:20.011607 |             0 | async      | 1999-12-21 01:02:47.357015+00
 61845 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59070 | 2025-10-05 16:51:36.247023+00 |              | streaming | 0/195C9F70 | 0/195C9F70 |           |            | 00:00:02.712712 | 00:00:19.773242 | 00:00:19.773242 |             0 | async      | 1999-12-21 01:02:47.357017+00
 61844 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59074 | 2025-10-05 16:51:36.246535+00 |              | streaming | 0/195C9F70 | 0/195C9F70 |           |            | 00:00:01.881853 | 00:00:19.88381  | 00:00:19.88381  |             0 | async      | 1999-12-21 01:02:47.357019+00
 61849 |    16489 | debezium_20251005_124647 | Debezium Streaming | 10.244.1.11 |                 |       59124 | 2025-10-05 16:51:36.348771+00 |              | streaming | 0/195C9F70 | 0/195C9F70 |           |            | 00:00:03.000003 | 00:00:20.011011 | 00:00:20.011011 |             0 | async      | 1999-12-21 01:02:47.357126+00
(4 rows)
[2025-10-05 12:52:04] [DEBUG] schema.registry.basic.auth.user.info=admin:iPanqDrNu1tDy6UEmE9ul7W8v
[2025-10-05 12:52:04] [DEBUG] Waiting 6 seconds for kafka-avro-console-consumer to start...
[2025-10-05 12:52:10] [INFO] Waiting for CDC to process INSERT...
[2025-10-05 12:54:12] [INFO] CDC test passed
[2025-10-05 12:54:12] [SUCCESS] End-to-end validation completed successfully
[2025-10-05 12:54:12] [SUCCESS] Task 13 credential rotation completed successfully!
[2025-10-05 12:54:12] [INFO] Log file saved to: /e/Projects/DataPipe/1-data-ingestion-pipeline/../logs/data-ingestion/task13-logs/credential-rotation.log
[2025-10-05 12:54:12] [INFO] Remember to:
[2025-10-05 12:54:12] [INFO] 1. Monitor the pipeline for the next 24 hours
[2025-10-05 12:54:12] [INFO] 2. Clean up old PostgreSQL users after validation period
[2025-10-05 12:54:12] [INFO] 3. Remove credential backups after confirming stability
